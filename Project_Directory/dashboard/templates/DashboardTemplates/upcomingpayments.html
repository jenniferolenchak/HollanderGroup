<html lang="en">

<!-- Establish Metadata -->

<head>
  <title>Savester - Upcoming Payments</title>
  <meta charset="UTF-8">
  <meta name="description" content="Savester Upcoming Payments">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Establish Style of Website Body -->
  <style>
    body {
      font-family: Arial, Times New Roman, Helvetica;
      margin: 0;
    }

    .header {
      padding: 10px;
      text-align: center;
      background: #57D557;
      color: white;
      font-size: 30px;
    }

    .content {
      padding: 20px;
    }

    .navbar {
      overflow: hidden;
      background-color: 215221;

    }

    .navbar button {
      float: left;
      color: black;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
      background-color: white;
    }

	.navbar buttonCurrent {
      float: left;
      color: black;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
      background-color: lightgray;
    }

    .navbar button:hover {
      background-color: #ddd;
      color: black;
    }

    .navbar button.active {
      background-color: lightgray;
      color: black;
    }

	button {
      color: black;
      text-align: center;
      padding: 5px 10px;
      text-decoration: none;
      font-size: 14px;
      background-color: lightgreen;
    }

	td, th {
 	border: 2px solid #dddddd;
 	text-align: left;
  	padding: 8px;
	}

	tr:nth-child(odd)
	{
	  background-color: lightgray;
	}

	tr:nth-child(even)
	{
	  background-color: #dddddd;
	}

    .background {
      overflow: hidden;
      background-color: lightgreen;

    }

  #userPic {
    border-radius: 50%;
    border: 10px solid darkgreen;
    margin-right: 30px;
    margin-left: 50px;
    margin-top: 30px;
    margin-bottom: 0px;
  }

</style>

<script type="text/JavaScript">
        function showMessage(){
            var message = document.getElementById("time").value;
            display_message.innerHTML= "Payments in selected time:" + message;
        }
    </script>

</head>

<!-- Establish content of website body -->

<body>
  <div class="header">
    <img
      src="https://github.com/jenniferolenchak/Savester/blob/main/Graphics/Savester%20Logo%204%20_%20green%20background.JPG?raw=true"
      alt="" width=200 height=200 align="left" padding=90 />

    {% if request.user.settings.icon_url %}
      <img id='userPic'
      src="{{ request.user.settings.icon_url }}"
      alt="" width=120 height=120 align="right" padding=0 />

    {% else %}
      <img id='userPic'
        src="https://st3.depositphotos.com/4111759/13425/v/600/depositphotos_134255532-stock-illustration-profile-placeholder-male-default-profile.jpg"
        alt="" width=120 height=120 align="right" padding=0 />
    {% endif %}


    <h1>Welcome to Savester</h1>
    <p>Secure Budgeting, Reimagined</p>
  </div>

  <div class="navbar">
    <a href="{% url 'dashboard' %}">
      <button href="#news">Dashboard</button>
    </a>
    <a href="{% url 'editmydata' %}">
      <button href="#news">Edit My Data</button>
    </a>
    <a href="{% url 'savingsuggestions' %}">
      <button href="#news">Saving Suggestions</button>
    </a>
    <a href="{% url 'upcomingpayments' %}">
		<buttonCurrent href="#news">Upcoming Payments</buttonCurrent>
    </a>
    <a href="{% url 'settings' %}">
      <button href="#news">Settings</button>
    </a>
    <a href="{% url 'logout' %}">
      <button href="#news">Logout</button>
    </a>
  </div>

    <div class="content">

	<center>
		<h3>View Options</h3>

      <a href="{% url 'savingsuggestions' %}">
      <button>View Payments in Specific Date Range</button>
    </a>

	or

	<a href="{% url 'allpayments' %}">
		<button>View All Payments</button>
    </a>

	<p><br></p>
  <h3>Upcoming Cash Flows</h3>
	<table>
  	<tr>
      <th>Name</th>
    	<th>Date</th>
    	<th>Amount</th>
    	<th>Payment or Income</th>
    	<th>Description</th>
 	</tr>
   {% for flow in upcoming_payments %}
	<tr>
      <td>{{flow.name}}</td>
    	<td>{{flow.date}}</td>
    	<td>${{flow.amount}}</td>
    	<td><font color=green>{{flow.type}}</font></td>
    	<td>{{flow.description}}</td>
      <td><a href="{% url 'removecashflow' flow.pk %}">
        <button>Remove</button>
        </a></td>
 	</tr>

   {% endfor %}
	</table>
  <a href="{% url 'addnewpayment' %}">
		<button>Add New Payment</button>
    </a>

<br><br><br>
<div class="background">
<label for="time">View total payments during: </label>
<select name="time" id="time">
  <option value="${{ payments_last_7_days|floatformat:2 }}">The Past 7 Days</option>
  <option value="${{ payments_last_30_days|floatformat:2 }}">The Past 30 Days</option>
  <option value="${{ payments_last_365_days|floatformat:2 }}">The Past 1 Year</option>
  <option value="${{ upcoming_payments_7_days|floatformat:2 }}">The Next 7 Days</option>
  <option value="${{ upcoming_payments_30_days|floatformat:2 }}">The Next 30 Days</option>

</select>

<input type="button" onclick="showMessage()" value="View" />
</form>


<p style="background-color:lightgreen"><span id = "display_message"></span> </p>


	</center>

   	</div>

  <br><br>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

  <center>
  <h2>Income vs Payments</h2>
  <h4>The Next 30 Days</h4>
  <center>
  </canvas><canvas id="myChart" width="400" height="400"></canvas>
  <script>
  var ctx = document.getElementById('myChart').getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'bar',
    beginAtZero: true,
    data: {
      labels: ['The Next 30 Days'],
      datasets: [{
        label: 'Income',
        data: [{{ upcoming_income_30_days|floatformat:2 }},],
        backgroundColor: 'darkgreen',
      }, {
        label: 'Payments',
        data: [{{ upcoming_payments_30_days|floatformat:2 }},],
        backgroundColor: 'darkred',
      }]
    },
    options: {
    responsive: false,
    scales: {
        yAxes: [{
            ticks: {
                beginAtZero: true
            }
        }]
    }
}
  });
  </script>

  <br><br><br><br>

  <center>
  <h2>% of Income Spent</h2>
  <h4>The Next 30 Days</h4>
  <center>
  </canvas><canvas id="chart2" width="400" height="400"></canvas>
  <script>
  var ctx = document.getElementById('chart2').getContext('2d');
  var myChart = new Chart(document.getElementById("chart2"), {
    type: 'doughnut',
    data: {
      labels: ["Spent", "Not Spent"],
      datasets: [
        {
          backgroundColor: ["darkblue", "lightblue"],
          borderColor: ["white", "black"],
          data: [{{ upcoming_payments_30_days|floatformat:2 }}, ({{ upcoming_income_30_days}} - {{ upcoming_payments_30_days}})]
        }
      ]
    },
    options: {
      responsive: false,
      title: {
        display: true,
        text: 'Predicted world population (millions) in 2050'
      }
    }
});
</script>

</body>

</html>
